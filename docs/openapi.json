{
    "openapi": "3.0.0",
    "info": {
      "title": "AJIO-Clone Backend API",
      "version": "1.0.0",
      "description": "Netlify Functions + Supabase backend for products and cart management."
    },
    "servers": [
      {
        "url": "https://{site}.netlify.app/.netlify/functions",
        "description": "Deployed Netlify Functions",
        "variables": {
          "site": {
            "default": "your-netlify-site",
            "description": "Your Netlify site subdomain"
          }
        }
      },
      {
        "url": "http://localhost:8888/.netlify/functions",
        "description": "Local Netlify Dev"
      }
    ],
    "paths": {
      "/products": {
        "get": {
          "tags": ["Products"],
          "summary": "List all products",
          "description": "Returns an array of all products, each with id, name, and image URL.",
          "responses": {
            "200": {
              "description": "Array of product summaries",
              "content": {
                "application/json": {
                  "schema": {
                    "type": "array",
                    "items": { "$ref": "#/components/schemas/ProductSummary" }
                  }
                }
              }
            },
            "500": {
              "description": "Internal server error",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            }
          }
        },
        "post": {
          "tags": ["Products"],
          "summary": "Create a new product",
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ProductCreateRequest" }
              }
            }
          },
          "responses": {
            "201": {
              "description": "Created product",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/ProductDetail" }
                }
              }
            },
            "400": {
              "description": "Invalid request",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            },
            "500": {
              "description": "Internal server error",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            }
          }
        },
        "put": {
          "tags": ["Products"],
          "summary": "Update a product",
          "parameters": [
            {
              "name": "id",
              "in": "query",
              "required": true,
              "schema": { "type": "string", "format": "uuid" },
              "description": "UUID of the product to update"
            }
          ],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ProductUpdateRequest" }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Updated product",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/ProductDetail" }
                }
              }
            },
            "400": {
              "description": "Invalid request",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            },
            "404": {
              "description": "Product not found",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            },
            "500": {
              "description": "Internal server error",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            }
          }
        }
      },
      "/products/{id}": {
        "get": {
          "tags": ["Products"],
          "summary": "Get product details",
          "parameters": [
            {
              "name": "id",
              "in": "path",
              "required": true,
              "schema": { "type": "string", "format": "uuid" }
            }
          ],
          "responses": {
            "200": {
              "description": "Product detail",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/ProductDetail" }
                }
              }
            },
            "404": {
              "description": "Product not found",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            },
            "500": {
              "description": "Internal server error",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            }
          }
        }
      },
      "/cart": {
        "post": {
          "tags": ["Cart"],
          "summary": "Create a new cart",
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/CartCreateRequest" }
              }
            }
          },
          "responses": {
            "201": {
              "description": "Cart created",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/CartCreateResponse" }
                }
              }
            },
            "400": {
              "description": "Invalid request",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            },
            "500": {
              "description": "Internal server error",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            }
          }
        },
        "get": {
          "tags": ["Cart"],
          "summary": "Get cart items or lookup cart by user",
          "parameters": [
            {
              "name": "id",
              "in": "query",
              "schema": { "type": "string", "format": "uuid" },
              "description": "UUID of the cart"
            },
            {
              "name": "userId",
              "in": "query",
              "schema": { "type": "string" },
              "description": "User identifier"
            }
          ],
          "responses": {
            "200": {
              "description": "Cart items or cart ID",
              "content": {
                "application/json": {
                  "schema": {
                    "oneOf": [
                      {
                        "type": "array",
                        "items": { "$ref": "#/components/schemas/CartItem" }
                      },
                      { "$ref": "#/components/schemas/CartCreateResponse" }
                    ]
                  }
                }
              }
            },
            "400": {
              "description": "Missing query parameter",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            },
            "404": {
              "description": "Cart not found",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            },
            "500": {
              "description": "Internal server error",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            }
          }
        },
        "put": {
          "tags": ["Cart"],
          "summary": "Add or update a cart item",
          "parameters": [
            {
              "name": "id",
              "in": "query",
              "required": true,
              "schema": { "type": "string", "format": "uuid" },
              "description": "UUID of the cart"
            }
          ],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/CartItemRequest" }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Upserted cart item",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/CartItemRequest" }
                }
              }
            },
            "400": {
              "description": "Invalid request",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            },
            "404": {
              "description": "Cart not found",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            },
            "500": {
              "description": "Internal server error",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            }
          }
        }
      },
      "/docs": {
        "get": {
          "tags": ["Documentation"],
          "summary": "Get API documentation",
          "description": "Returns the OpenAPI JSON specification.",
          "responses": {
            "200": {
              "description": "OpenAPI document",
              "content": {
                "application/json": {
                  "schema": { "type": "object" }
                }
              }
            },
            "500": {
              "description": "Error loading documentation",
              "content": {
                "application/json": {
                  "schema": { "$ref": "#/components/schemas/Error" }
                }
              }
            }
          }
        }
      }
    },
    "components": {
      "schemas": {
        "ProductSummary": {
          "type": "object",
          "required": ["id", "name", "image"],
          "properties": {
            "id": { "type": "string", "format": "uuid" },
            "name": { "type": "string" },
            "image": { "type": "string", "format": "uri" }
          }
        },
        "ProductDetail": {
          "type": "object",
          "required": ["title", "description", "actual_price", "discounted_price", "discount_percentage"],
          "properties": {
            "title": { "type": "string" },
            "description": { "type": "string" },
            "short_description": { "type": "string" },
            "ratings": { "type": "number" },
            "review_count": { "type": "integer" },
            "actual_price": { "type": "number" },
            "discounted_price": { "type": "number" },
            "discount_percentage": { "type": "number" },
            "additional_details": { "type": "object", "additionalProperties": true },
            "image_path": { "type": "string" }
          }
        },
        "ProductCreateRequest": {
          "allOf": [
            { "$ref": "#/components/schemas/ProductDetail" }
          ]
        },
        "ProductUpdateRequest": {
          "type": "object",
          "properties": {
            "title": { "type": "string" },
            "description": { "type": "string" },
            "short_description": { "type": "string" },
            "ratings": { "type": "number" },
            "review_count": { "type": "integer" },
            "actual_price": { "type": "number" },
            "discounted_price": { "type": "number" },
            "discount_percentage": { "type": "number" },
            "additional_details": { "type": "object", "additionalProperties": true },
            "image_path": { "type": "string" }
          }
        },
        "CartCreateRequest": {
          "type": "object",
          "required": ["userId"],
          "properties": { "userId": { "type": "string" } }
        },
        "CartCreateResponse": {
          "type": "object",
          "properties": { "cartId": { "type": "string", "format": "uuid" } }
        },
        "CartItem": {
          "type": "object",
          "required": ["product_id", "quantity"],
          "properties": {
            "product_id": { "type": "string", "format": "uuid" },
            "quantity": { "type": "integer" }
          }
        },
        "CartItemRequest": {
          "type": "object",
          "required": ["productId", "quantity"],
          "properties": {
            "productId": { "type": "string", "format": "uuid" },
            "quantity": { "type": "integer" }
          }
        },
        "Error": {
          "type": "object",
          "properties": {
            "error": { "type": "string" }
          }
        }
      }
    }
  }
  